{"paragraphs":[{"text":"import spark.implicits._\n\nimport org.apache.spark.sql.functions._\n\nimport scala.collection.mutable.WrappedArray\n\nval spark = new org.apache.spark.sql.SQLContext(sc)\n\nval business = spark.read.json(\"/usr/shivraj/yelp_academic_dataset_business.json\")\n\nval b = business.withColumn(\"category\", explode(\n    when(col(\"categories\").isNotNull, col(\"categories\"))\n    .otherwise(array(lit(null).cast(\"string\")))\n    ))\n\nb.registerTempTable(\"business\")\n\nval business_df = spark.sql(\"select city,category,sum(review_count) from business where city='Madison' OR city='Pittsburgh' OR city='Charlotte' OR city='Phoenix' OR city='Cleveland' OR city='Urbana' OR city='Las Vegas' group by city,category Order by city\")\nbusiness_df.write\n  .option(\"header\", \"true\")\n  .csv(\"/usr/shivraj/q1Spark.csv\")","user":"anonymous","dateUpdated":"2017-03-12T23:24:06+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1489360372382_-841148447","id":"20170312-231252_1682674273","result":{"code":"SUCCESS","type":"TEXT","msg":"\nimport spark.implicits._\n\nimport org.apache.spark.sql.functions._\n\nimport scala.collection.mutable.WrappedArray\n\nwarning: there was one deprecation warning; re-run with -deprecation for details\n\nspark: org.apache.spark.sql.SQLContext = org.apache.spark.sql.SQLContext@190d32be\n\nbusiness: org.apache.spark.sql.DataFrame = [address: string, attributes: array<string> ... 14 more fields]\n\nb: org.apache.spark.sql.DataFrame = [address: string, attributes: array<string> ... 15 more fields]\n\nwarning: there was one deprecation warning; re-run with -deprecation for details\n\nbusiness_df: org.apache.spark.sql.DataFrame = [city: string, category: string ... 1 more field]\n"},"dateCreated":"2017-03-12T23:12:52+0000","dateStarted":"2017-03-12T23:24:06+0000","dateFinished":"2017-03-12T23:24:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4365"},{"text":"","user":"anonymous","dateUpdated":"2017-03-12T23:24:06+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1489360613579_-307564664","id":"20170312-231653_1340277399","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"2017-03-12T23:16:53+0000","dateStarted":"2017-03-12T23:24:07+0000","dateFinished":"2017-03-12T23:24:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4366"}],"name":"q1","id":"2CCB55G35","angularObjects":{"2CAAUKHWB:shared_process":[],"2CC7GR9KR:shared_process":[],"2CBUX3KCQ:shared_process":[],"2CE1XEF5G:shared_process":[],"2CBKW4JUC:shared_process":[],"2CD4QAWFX:shared_process":[],"2CCZ89BJ2:shared_process":[],"2CAB6HT57:shared_process":[],"2CDW55RX1:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}