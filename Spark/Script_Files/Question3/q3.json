{"paragraphs":[{"text":"import spark.implicits._\n\nimport org.apache.spark.sql.functions._\n\nimport scala.collection.mutable.WrappedArray\n\nval spark = new org.apache.spark.sql.SQLContext(sc)\n\nval business = spark.read.json(\"/usr/shivraj/yelp_academic_dataset_business.json\")\n\nval b = business.withColumn(\"category\", explode(\n    when(col(\"categories\").isNotNull, col(\"categories\"))\n    .otherwise(array(lit(null).cast(\"string\")))\n    ))\n\nb.registerTempTable(\"business\")\n\nval q3Output=spark.sql(\"SELECT category,AVG(stars) AS stars from business WHERE latitude<=43.2467 and latitude>=42.90833 and longitude>=-89.58389 and longitude<=-89.25056 GROUP BY category ORDER BY stars DESC\")\n\nq3Output.write\n  .option(\"header\", \"true\")\n  .csv(\"/usr/shivraj/q3Spark.csv\")","user":"anonymous","dateUpdated":"2017-03-12T23:31:09+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1489361344986_-224620890","id":"20170312-232904_2094432447","result":{"code":"SUCCESS","type":"TEXT","msg":"\nimport spark.implicits._\n\nimport org.apache.spark.sql.functions._\n\nimport scala.collection.mutable.WrappedArray\n\nwarning: there was one deprecation warning; re-run with -deprecation for details\n\nspark: org.apache.spark.sql.SQLContext = org.apache.spark.sql.SQLContext@67097086\n\nbusiness: org.apache.spark.sql.DataFrame = [address: string, attributes: array<string> ... 14 more fields]\n\nb: org.apache.spark.sql.DataFrame = [address: string, attributes: array<string> ... 15 more fields]\n\nwarning: there was one deprecation warning; re-run with -deprecation for details\n\nq3Output: org.apache.spark.sql.DataFrame = [category: string, stars: double]\n"},"dateCreated":"2017-03-12T23:29:04+0000","dateStarted":"2017-03-12T23:31:09+0000","dateFinished":"2017-03-12T23:31:19+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5078"},{"text":"","user":"anonymous","dateUpdated":"2017-03-12T23:31:09+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1489361411229_-1250068654","id":"20170312-233011_1522436196","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"2017-03-12T23:30:11+0000","dateStarted":"2017-03-12T23:31:09+0000","dateFinished":"2017-03-12T23:31:19+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5079"}],"name":"q3","id":"2CDGG651D","angularObjects":{"2CAAUKHWB:shared_process":[],"2CC7GR9KR:shared_process":[],"2CBUX3KCQ:shared_process":[],"2CE1XEF5G:shared_process":[],"2CBKW4JUC:shared_process":[],"2CD4QAWFX:shared_process":[],"2CCZ89BJ2:shared_process":[],"2CAB6HT57:shared_process":[],"2CDW55RX1:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}